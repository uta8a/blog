---
type: "post"
title: "業務に関係ない技術雑談会 2023-07-21回"
draft: false
description: "Arduinoやその他ボードの話、マストドンサーバを建てた話、mallocの話、未定義動作の話"
ogp: 'ogp-big.webp'
changelog:
  - summary: 記事作成
    date: "2023-07-22T14:22:26+09:00"
---

<!-- titleは自動で入る -->
社の同期と、「なんか技術オタク語りしたいよね」というノリで業務に全く関係なく自分の趣味進捗や技術的な話題で盛り上がる会をしています。隔週で行っていて今回が5回目です。
こちらはその記録と、分からなかったことを個人的に復習をして追記したものになります。

# 会について

参加者は8人でした。それぞれが最初に話したいネタを書いて、順番に心ゆくまで双方向に雑談をします。時間が来たら切り上げる形式です。全部で2時間くらいの会でした。(途中参加・途中抜け自由なので自由に抜けていったりしました)
今回は特にテーマもないので「最近の趣味進捗や話したいこと」という題材でネタを出しました。

# Arduinoやその他ボードの話

[Arduino Uno R4 Minima](https://www.switch-science.com/products/9000) という新しいArduinoのボードが出たという話。
まずArduinoって聞いたことくらいしかないな、という話が出たのでマイコンの説明がされました。

- マイコンは今使っているPCよりも非力なCPUとちっちゃいメモリで動いている
  - マイコンは安くて消費電力が低いのが嬉しい
- Linuxがまともに動かないようなボードもある
  - Q. どうやってプログラムを動かすんですか？→A.ベアメタル環境というOSの下の環境で動かします。
- GPIOがあるボード
  - カメラ越しにGPIOのピンを見せたりしました。
- 意外とみんなマシンを持っていて、zoomのカメラ越しにボードを見せ合いました。
  - FPGAを持っている人が4人
  - microbit
  - Raspberry pi 4, Raspberry pi pico(自作キーボードのRustyKeysの一部として)
  - RISC-Vボード: Visionfive 2
  - ARMのボード
  - M5stack paper

## なぜボードの一部はLinuxがまともに動かない？

メモリが少ないからです。
Linuxをどう定義するかにもよるのですが、無理なくLinuxを動作させるためには最低でも数MBは必要で、それに対してArduinoの例えばArm Cortex-M4のRAMは数百KBくらいしかないし、外部RAMも搭載していません。

OSがなくてもプログラムを動かすことはできて、Arduinoだとこのピンに1を書き込むとある機能が使えます、みたいなところがうまく抽象化されているのでArduino IDEを使えば普通にぽちぽちプログラミングするだけで使えるという話がされました。

## マイコンの構造

![GPIO](1.jpg)

コンピュータの計算装置が外部とデータのやり取りをするために、バスを介して周辺機能を使う必要があります。
例えば、以下のような周辺機能があります。

- UART: Universal Asynchronous Receiver Transmitter は非同期にシリアル通信が行えます。
- GPIO: General Purpose Input/Output は入出力に使えるデジタル信号の出入り口として機能します。

参考: [CPUとメモリだけでは動かない！マイコン活用に必須の「周辺機能」とは](https://www.renesas.com/jp/ja/support/engineer-school/mcu-programming-peripherals-01-gpio)

## UARTとは？

2つの機器が通信をするとき、1ビットずつデータを送る通信方式のことをシリアル通信と言います。

![comm](2.jpg)

それに対して、複数ビットを複数のケーブルで同時に送る通信方式のことをパラレル通信と言います。

パラレル通信だと同時に送った各ビットがどの順番か整理する必要があるので規格が複雑になります。そこで、マイコンやマイコンとPCを繋ぐ際には比較的単純なシリアル通信が使用されます。

**UARTはこのシリアル通信の規格であるRS-232で使われる通信方式のことです。** 元々はその通信を行うチップを指していましたが、現在ではこのあたりは結構用語が雑に使われています。

実際に私はFPGAとPCで通信をするときにUARTを使いました。

参考:
- [シリアル通信とは,パラレル通信との違い～制御工学の基礎あれこれ～](https://taketake2.com/M44.html)
- [シリアル通信で Hello, FPGA (2) | ACRi Blog](https://www.acri.c.titech.ac.jp/wordpress/archives/660)

## GPIOとは？

(#TODO)

## 低レイヤーになぜ興味を持つのか？

# マストドンのサーバを建てた話

[mastodon](https://joinmastodon.org/ja) というSNSはOSSで公開されていて誰でもVPSのようなマシンを借りて用意するなどして自前でSNSをホスティングできます。それをやってみたら意外と簡単にできたよという話。

マストドンを建てる手順は

# 未定義動作とC++の話

[// なぜかこの行がないと動かない - Qiita](https://qiita.com/BlueRayi/items/996e09ac50880d8c9f53) を説明しつつ、未定義動作とは何か？について説明する話。


